function isWeiXin(){return"micromessenger"==global.ua.match(/MicroMessenger/i)}function mySetLocalStorage(e,a){mui.os.plus?"string"==typeof a?plus.storage.setItem(e,a):plus.storage.setItem(e,JSON.stringify(a)):"string"==typeof a?localStorage.setItem(e,a):localStorage.setItem(e,JSON.stringify(a))}function myGetLocalStorage(e){return mui.os.plus?plus.storage.getItem(e):localStorage.getItem(e)}function myRemoveLocalStorage(e){mui.os.plus?plus.storage.removeItem(e):localStorage.removeItem(e)}function myClearStorage(){mui.os.plus?plus.storage.clear():localStorage.clear()}function myOpenWindow(e,a){mui.os.plus?mui.openWindow({url:e,id:a,createNew:!0,show:{aniShow:!0},waiting:{autoShow:!0},styles:{scrollIndicator:"none"}}):mui.openWindow({url:e,id:a,show:{aniShow:"pop-in"}})}function myOpenWindowFooter(e,a){mui.os.plus?mui.openWindow({url:e,id:a,show:{aniShow:!1},waiting:{autoShow:!1},styles:{scrollIndicator:"none"}}):mui.openWindow({url:e,id:a,show:{aniShow:"pop-in"}})}function myInit(e){mui.os.plus?mui.plusReady(function(){e()}):e()}function myToast(e){mui.os.plus?plus.nativeUI.toast(e):mui.toast(e)}function myAlert(e,a){mui.os.plus?a?plus.nativeUI.alert(e,a()):plus.nativeUI.alert(e):a?mui.alert(e,a()):mui.alert(e)}function myConfirm(e,a,t){mui.os.plus?plus.nativeUI.confirm(e,function(e){0==e.index?a&&a():t&&t()}):mui.confirm(e,function(e){1==e.index?a&&a():t&&t()})}function myLoading(){mui.os.plus?plus.nativeUI.showWaiting():mask.loading()}function myLoadingOver(){mui.os.plus?plus.nativeUI.closeWaiting():mask.remove("mask")}function myCommon(){mui.os.plus?(global.apiURL="http://service.project.cbylsj.com/",mui.plusReady(function(){plus.webview.currentWebview().setStyle({scrollIndicator:"none"})})):global.apiURL=window.location.origin}function createMask(){var e=document.createElement("div");e.setAttribute("class","mask"),document.body.appendChild(e)}function againLogin(e,a){function t(){myOpenWindow("/tpl/login/login.html","login")}var s=JSON.parse(myGetLocalStorage("user"));if(null!=s){var r=s.mobile,n=s.springtoken;mui.ajax(global.apiURL+"/yztz_user_login_check.htm",{data:{username:r,password:"123456",springtoken:n},dataType:"json",type:"post",timeout:1e4,success:function(t){t.success?setUserInfo(t,e,a):mui.toast(t.resultMsg)},error:function(e,a,t){mui.toast("服务器正忙，请稍后重试！")}})}else myAlert("您还未登录，请先登录",t)}function setUserInfo(e,a,t){mui.ajax(global.apiURL+"/user/staffLogin.htm",{data:{},dataType:"json",type:"post",success:function(s){if(s.success){var s=s.data,r=s[0].company;r||(r=s[0].companyName),mySetLocalStorage("user",{springtoken:e.springtoken,nickname:e.userName,mobile:s[0].userInfo.username,name:s[0].userInfo.name,jobId:s[0].userInfo.jobId,personnelNature:s[0].personnelNature,userId:s[0].userId,company:r,imageAddress:s[0].userInfo.imageAddress}),t.length<1?a():a(t)}else myToast(s.resultMsg)},error:function(){myToast("服务器正忙，请稍后重试！")}})}function formatCurrency(e){e=e.toString().replace(/\$|\,/g,""),isNaN(e)&&(e="0"),sign=e==(e=Math.abs(e)),e=Math.floor(100*e+.50000000001),cents=e%100,e=Math.floor(e/100).toString(),cents<10&&(cents="0"+cents);for(var a=0;a<Math.floor((e.length-(1+a))/3);a++)e=e.substring(0,e.length-(4*a+3))+","+e.substring(e.length-(4*a+3));return(sign?"":"-")+e+"."+cents}function formatCurrency1(e){e=e.toString().replace(/\$|\,/g,""),isNaN(e)&&(e="0"),sign=e==(e=Math.abs(e)),e=Math.floor(100*e+.50000000001),cents=e%100,e=Math.floor(e/100).toString(),cents<10&&(cents="0"+cents);for(var a=0;a<Math.floor((e.length-(1+a))/3);a++)e=e.substring(0,e.length-(4*a+3))+","+e.substring(e.length-(4*a+3));return(sign?"":"-")+e}function getMesNum(){mui.ajax(global.apiURL+"/message/user/getMessageCount.htm",{data:{},dataType:"json",type:"post",timeout:1e4,success:function(e){if(e.success){var a=e.num;0!=a?(a>=99&&(a=99),document.querySelector(".message-num").style.display="block",document.querySelector(".message-num").innerHTML=a):document.querySelector(".message-num").style.display="none"}else"405"==e.code&&"请登录系统"==e.resultMsg&&againLogin(getMesNum,[])},error:function(){mui.toast("服务器正忙，请稍后重试！")}})}function getPushInfo(){if(mui.os.plus){var e=plus.push.getClientInfo();alert("获取客户端推送标识信息："),alert("id: "+e.id),alert("token: "+e.token),alert("clientid: "+e.clientid),alert("appid: "+e.appid),alert("appkey: "+e.appkey)}}var zjzm=zjzm||{},global={viewWidth:document.body.scrollWidth,viewHeight:document.body.scrollHeight,ua:window.navigator.userAgent.toLowerCase(),mobileReg:/^1[3|4|5|7|8|][0-9]{9}$/,emailReg:/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,pwdReg:/^([0-9a-zA-Z_]|[~!@#$%^&*\(\)\_\+\=\{\}\[\]\?\/\,\.]){6,20}$/,cardReg:/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/,apiURL:""},base={fontSize:50,maxWidth:640,menu:["首页","项目","消息","我的"]};isWeiXin()&&(document.getElementsByTagName("title")[0].innerHTML=""),zjzm.initFontSize=function(e){var a=e/base.maxWidth*base.fontSize;document.getElementsByTagName("html")[0].style.fontSize=a+"px"},zjzm.initFontSize(global.viewWidth),window.addEventListener("resize",function(){var e=document.documentElement.clientWidth;zjzm.initFontSize(e)}),myCommon(),zjzm.mobileValidate=function(e){return!!global.mobileReg.test(e)},zjzm.emailValidate=function(e){return!!global.emailReg.test(e)},zjzm.pwdValidate=function(e){return!!global.pwdReg.test(e)},zjzm.identification=function(e){var a,e=e.toUpperCase().split(""),t=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],s=[1,0,"X",9,8,7,6,5,4,3,2],r=0;if(18!=e.length&&15!=e.length)a=!1;else if(18==e.length){for(var n=0;n<t.length;n++)r+=Number(t[n])*Number(e[n]);a=s[r%11]==e[e.length-1]}return a},zjzm.trim=function(e){return e.replace(/\s/g,"")},zjzm.countDown=function(e,a){var t=e.innerHTML,a=a,s=1,r=setInterval(function(){var n=a-s;s>a-1?(s=1,e.removeAttribute("disabled"),e.innerHTML=t,clearInterval(r)):(e.setAttribute("disabled",!0),e.innerHTML=n+"秒后重发",s++)},1e3)};var mask={loading:function(){createMask(),document.querySelector(".mask").innerHTML="<img src='"+global.apiURL+"/images/icon/loading.gif' class='loading' />"},remove:function(e){e&&document.querySelector("."+e).remove()},filter:function(){createMask()}};zjzm.step=function(e){var a="";switch(e){case 5:a="项目保存";break;case 10:a="项目录入";break;case 20:a="待项目立项";break;case 30:a="待负责人反馈";break;case 40:a="待确立负责人";break;case 50:a="待录入招标公告";break;case 60:a="待上传报名拟定";break;case 70:a="待经营审核报名";break;case 80:a="待技术审核报名";break;case 90:a="报名行政盖章";break;case 100:a="待上传报名文件";break;case 110:a="待上传招标文件";break;case 120:a="待申请保证金";break;case 130:a="待经营审核保证金";break;case 140:a="待技术审核保证金";break;case 150:a="待财务审核保证金";break;case 160:a="待院办审核保证金";break;case 170:a="待出纳保证金打款";break;case 190:a="待上传商务标拟定";break;case 200:a="待经营审核商务标";break;case 210:a="待技术审核商务标";break;case 220:a="待院办审核商务标";break;case 230:a="待商务标行政盖章";break;case 240:a="待上传技术标拟定";break;case 250:a="待总工审核技术标";break;case 260:a="待院办审核技术标";break;case 270:a="待技术标行政盖章";break;case 280:a="待上传投标文件";break;case 290:a="待录入开标记录";break;case 300:a="待上传合同拟定";break;case 310:a="待经营审核合同";break;case 315:a="待总工审核合同";break;case 320:a="待技术审核合同";break;case 330:a="待财务审核合同";break;case 340:a="待法务审核合同";break;case 350:a="待院办审核合同";break;case 360:a="待合同行政盖章";break;case 370:a="待上传合同文件";break;case 380:a="待申请合作比例";break;case 390:a="待院办审核合作比例";break;case 400:a="待上传方案初稿";break;case 410:a="待总工审核方案";break;case 420:a="待上传方案成果";break;case 430:a="待上传扩初初稿";break;case 440:a="待总工审核扩初";break;case 450:a="待上传扩初成果";break;case 460:a="待上传施工初稿";break;case 470:a="待总工审核施工";break;case 480:a="待上传施工成果";break;case 490:a="待上传规划初稿";break;case 500:a="待总工审核规划";break;case 510:a="待上传规划成果";break;case 520:a="待上传竣工报告";break;case 530:a="待终止";break;case 610:a="正常";break;case 620:a="中止";break;case 630:a="正常";break;case 640:a="终止";break;case 818:a="项目修改"}return a},zjzm.subStep=function(e){var a="";switch(e){case 120:a="待申请保证金";break;case 130:a="待经营审核保证金";break;case 140:a="待技术审核保证金";break;case 150:a="待财务审核保证金";break;case 160:a="待院办审核保证金";break;case 170:a="待出纳保证金打款";break;case 190:a="待上传商务标拟定";break;case 200:a="待经营审核商务标";break;case 210:a="待技术审核商务标";break;case 220:a="待院办审核商务标";break;case 230:a="待商务标行政盖章";break;case 240:a="待上传技术标拟定";break;case 250:a="待总工审核技术标";break;case 260:a="待院办审核技术标";break;case 270:a="待技术标行政盖章"}return a},zjzm.subStep2=function(e){var a="";switch(e){case 120:a="待申请保证金";break;case 130:a="待经营审核保证金";break;case 140:a="待技术审核保证金";break;case 150:a="待财务审核保证金";break;case 160:a="待院办审核保证金";break;case 170:a="待出纳保证金打款";break;case 190:a="待上传商务标拟定";break;case 200:a="待经营审核商务标";break;case 210:a="待技术审核商务标";break;case 220:a="待院办审核商务标";break;case 230:a="待商务标行政盖章";break;case 240:a="待上传技术标拟定";break;case 250:a="待总工审核技术标";break;case 260:a="待院办审核技术标";break;case 270:a="待技术标行政盖章"}return a},zjzm.role=function(e){var a="";switch(e){case 1:a="院长";break;case 2:a="院办";break;case 3:a="经营部经理";break;case 4:a="经营专员";break;case 5:a="技术总监";break;case 6:a="技术专员";break;case 7:a="会计";break;case 8:a="出纳";break;case 9:a="行政";break;case 10:a="法务";break;case 11:a="总师办";break;case 12:a="总工助理"}return a},zjzm.formatBankCode=function(e){return e.replace(/\s/g,"").replace(/(\d{4})(?=\d)/g,"$1 ")},zjzm.initAdsList=function(e){function a(e){var a;a=1==e?"项目页banner":"首页banner",mui.ajax(global.apiURL+"/fileUpLoad/getFileByBasic.htm",{data:{categoryId:29,attributeId:4,fileName:a},dataType:"json",type:"post",timeout:1e4,success:function(e){if(e.success){var a=e.data;if(a.length){t(a),s(a);var r=mui("#slider");r.slider({interval:5e3})}}else document.querySelector(".banner").style.display="none"},error:function(e,a,t){mui.toast("服务器正忙，请稍后重试！")}})}function t(e){for(var a="",t=document.querySelector(".mui-slider-group"),s=0;s<e.length;s++){var r=e[s].fileAddress,n="";1!=e.length?(0==s&&(domFirst="<div class='mui-slider-item'>",""==n?domFirst+="<img src='"+r+"'>":domFirst+="<a href='"+n+"'><img src='"+r+"'></a>",domFirst+="</div>"),s==e.length-1&&(domEnd="<div class='mui-slider-item'>",""==n?domEnd+="<img src='"+r+"'>":domEnd+="<a href='"+n+"'><img src='"+r+"'></a>",domEnd+="</div>"),a+="<div class='mui-slider-item'>",a+=""==n?"<img src='"+r+"'>":"<a href='"+n+"'><img src='"+r+"'></a>",a+="</div>"):(domEnd=domFirst=a+="<div class='mui-slider-item'>",a+=""==n?"<img src='"+r+"'>":"<a href='"+n+"'><img src='"+r+"'></a>",a+="</div>")}t.innerHTML=domEnd+a+domFirst}function s(e){var a="",t=document.querySelector(".mui-slider-indicator");if(1!=e.length){for(var s=0;s<e.length;s++)a+=0==s?"<div class='mui-indicator mui-active'></div>":"<div class='mui-indicator'></div>";t.innerHTML=a}}a(e)},zjzm.formatDate=function(e,a){var t;if(8==e.length){var s=e.substring(0,4),r=e.substring(4,6),n=e.substring(6,8);t=s+a+r+a+n}else{if(6!=e.length)return;var s=e.substring(0,4),r=e.substring(4,6);t=s+a+r}return t},Date.prototype.Format=function(e){var a={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var t in a)new RegExp("("+t+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?a[t]:("00"+a[t]).substr((""+a[t]).length)));return e},zjzm.getDay=function(e,a){var t=new Date(e).Format(a);return t},zjzm.historyUrl=function(e){mySetLocalStorage("curr",e)},zjzm.getQueryString=function(e){var a=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),t=window.location.search.substr(1).match(a);return null!=t?unescape(t[2]):null};